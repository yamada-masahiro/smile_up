var i="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var r={};!function(i,a){r=a()}(window,(function(){return function(i){var r={};function n(a){if(r[a])return r[a].exports;var u=r[a]={i:a,l:!1,exports:{}};return i[a].call(u.exports,u,u.exports,n),u.l=!0,u.exports}return n.m=i,n.c=r,n.d=function(i,r,a){n.o(i,r)||Object.defineProperty(i,r,{enumerable:!0,get:a})},n.r=function(i){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},n.t=function(i,r){if(1&r&&(i=n(i)),8&r)return i;if(4&r&&"object"==typeof i&&i&&i.__esModule)return i;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:i}),2&r&&"string"!=typeof i)for(var u in i)n.d(a,u,function(r){return i[r]}.bind(null,u));return a},n.n=function(i){var r=i&&i.__esModule?function(){return i.default}:function(){return i};return n.d(r,"a",r),r},n.o=function(i,r){return Object.prototype.hasOwnProperty.call(i,r)},n.p="",n(n.s=2)}([function(i,r){i.exports=function(i,r){if(!(i instanceof r))throw new TypeError("Cannot call a class as a function")}},function(i,r){function n(i,r){for(var a=0;a<r.length;a++){var u=r[a];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(i,u.key,u)}}i.exports=function(i,r,a){return r&&n(i.prototype,r),a&&n(i,a),i}},function(r,a,u){u.r(a);var l=u(0),c=u.n(l),h=u(1),v=u.n(h);function o(i,r){r=r?r.replace(/([[\]().?\/*{}+$^:])/g,"$1"):" \\s ";var a=new RegExp("^[".concat(r,"]+"),"g");return i.replace(a,"")}function s(i){var r=Number(i);return r>=12353&&r<=12435||12445===r||12446===r}var g=/[^ 　ぁあ-んー]/g,p=/[ぁぃぅぇぉっゃゅょ]/g,d=function(){function t(r){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};c()(this||i,t),(this||i).isActive=!0,(this||i).timer=null,this.initializeValues(),(this||i).option=Object.assign({katakana:!1,debug:!1,checkInterval:30},u);var l=document.getElementById(o(r,"#")),h=document.getElementById(o(a,"#"));if(!l)throw new Error("Element not found: ".concat(r));(this||i).elName=l,this.registerEvents((this||i).elName),h&&((this||i).elFurigana=h)}return v()(t,[{key:"getFurigana",value:function(){return(this||i).furigana}},{key:"start",value:function(){(this||i).isActive=!0}},{key:"stop",value:function(){(this||i).isActive=!1}},{key:"toggle",value:function(r){if(r){var a=Event.element(r);a&&((this||i).isActive=a.checked)}else(this||i).isActive=!(this||i).isActive}},{key:"initializeValues",value:function(){(this||i).baseKana="",(this||i).furigana="",(this||i).isConverting=!1,(this||i).ignoreString="",(this||i).input="",(this||i).values=[]}},{key:"registerEvents",value:function(r){var a=this||i;r.addEventListener("blur",(function(){a.debug("blur"),a.clearInterval()})),r.addEventListener("focus",(function(){a.debug("focus"),a.onInput(),a.setInterval()})),r.addEventListener("keydown",(function(){a.debug("keydown"),a.isConverting&&a.onInput()}))}},{key:"clearInterval",value:function(r){function e(){return r.apply(this||i,arguments)}return e.toString=function(){return r.toString()},e}((function(){(this||i).timer&&clearInterval((this||i).timer)}))},{key:"toKatakana",value:function(r){if((this||i).option.katakana){for(var a,u="",l=0;l<r.length;l+=1)s(a=r.charCodeAt(l))?u+=String.fromCharCode(a+96):u+=r.charAt(l);return u}return r}},{key:"setFurigana",value:function(r){(this||i).isConverting||(r&&((this||i).values=r),(this||i).isActive&&((this||i).furigana=this.toKatakana((this||i).baseKana+(this||i).values.join("")),(this||i).elFurigana&&((this||i).elFurigana.value=(this||i).furigana)))}},{key:"removeString",value:function(r){if(-1!==r.indexOf((this||i).ignoreString))return String(r).replace((this||i).ignoreString,"");for(var a=(this||i).ignoreString.split(""),u=r.split(""),l=0;l<a.length;l+=1)a[l]===u[l]&&(u[l]="");return u.join("")}},{key:"checkConvert",value:function(r){if(!(this||i).isConverting)if(Math.abs((this||i).values.length-r.length)>1){var a=r.join("").replace(p,"").split("");Math.abs((this||i).values.length-a.length)>1&&this.onConvert()}else(this||i).values.length===(this||i).input.length&&(this||i).values.join("")!==(this||i).input&&(this||i).input.match(g)&&this.onConvert()}},{key:"checkValue",value:function(){var r;if(""===(r=(this||i).elName.value))this.initializeValues(),this.setFurigana();else{if(r=this.removeString(r),(this||i).input===r)return;if((this||i).input=r,(this||i).isConverting)return;var a=r.replace(g,"").split("");this.checkConvert(a),this.setFurigana(a)}this.debug((this||i).input)}},{key:"setInterval",value:function(r){function e(){return r.apply(this||i,arguments)}return e.toString=function(){return r.toString()},e}((function(){(this||i).timer=setInterval((this||i).checkValue.bind(this||i),(this||i).option.checkInterval)}))},{key:"onInput",value:function(){(this||i).elFurigana&&((this||i).baseKana=(this||i).elFurigana.value),(this||i).isConverting=!1,(this||i).ignoreString=(this||i).elName.value}},{key:"onConvert",value:function(){(this||i).baseKana=(this||i).baseKana+(this||i).values.join(""),(this||i).isConverting=!0,(this||i).values=[]}},{key:"debug",value:function(){var r;(this||i).option.debug&&(r=console).log.apply(r,arguments)}}]),t}();function f(i,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new d(i,r,a)}u.d(a,"bind",(function(){return f}))}])}));var a=r;const u=r.AutoKana;export default a;export{u as AutoKana};

